---
layout:     post
title:      python常用操作
subtitle:   剪裁文本、音频
date:       2019-09-09
author:     LT
header-img: 
catalog: true
tags:
    - python
    - 文件处理
---



### 文本：读写
```
import os
import sys
from numpy import *

# sys.path.append("./Qmdct_cover")
dir1 = "./Qmdct_cover/"
files1 = os.listdir(dir1)       #得到文件夹下的所有文件名称
dir2 = "./qmdct_cover_128_512/"

for file in files1:         #遍历文件夹
    f = open(dir1 + file, 'r');         # 读文件
    A = zeros((128,512), dtype=int) #先创建全零方阵A，并且数据的类型设置为float浮点型
    lines = f.readlines()           #把全部数据文件读到一个列表lines中
    A_row = 0                       #表示矩阵的行，从0行开始
    for line in lines:              #把lines中的数据逐行读取出来
        list = line.strip('\n').split(' ')  #strip表示把头尾的'\n'去掉，split表示以空格来分割行数据，然后把处理后的行数据返回到list列表中
        A[A_row:] = list[0:512]  #把处理后的数据放到方阵A中。
        A_row += 1  # 方阵A的下一行接着读
    f.close()
    # print(A)
    output = open(dir2 + file, 'w+')    #写文件
    for i in range(len(A)):
        for j in range(len(A[i])):
            output.write(str(A[i][j]))
            output.write(' ')
        output.write('\n')
    output.close()
```

### 音频：
1. 裁剪wav的前【128×1024】个样本点
```
from scipy.io import wavfile
import os

folder = "D:/to do/数据集/2000-歌曲wav（1声道，16 Khz, 32位，10s）/"
path_list = os.listdir(folder)

for i in range(len(path_list)):
    sample_rate, sig = wavfile.read(folder+path_list[i])
    buf = sig[ 1: 127*1024]
    wavfile.write('D:/Code Projects/wav_process/dataset_128×1024（1声道，16 Khz, 16位，8s）/' + path_list[i][7:], sample_rate, buf)

"""
if sig.dtype == np.int16:
    print("PCM16位整形")
if sig.dtype == np.float32:
    print("PCM32位浮点")
"""
```
2. 提取Qmdct
```
import os

folder = "D:/Code Projects/wav_process/dataset_128×1024（1声道，16 Khz, 16位，8s）/"
path_list = os.listdir(folder)

c1 = "d: & cd D:/Code Projects/wav_process/dataset_128×1024（1声道，16 Khz, 16位，8s）"
for i in range(len(path_list)):
    AACname = os.path.splitext(path_list[i])[0] + ".m4a"
    Qmdct_name = path_list[i] + "Qmdct_cover.txt"
    c2 = "faac_Qmdct_generate -o " + "../aac_cover/" + AACname + " " + path_list[i]
    c3 = "move " + Qmdct_name + " ../Qmdct_cover/"
    command = c1 + "&" + c2 + "&" + c3
    os.system(command)

```